name: PR Comment Workflow

on:
  issue_comment:
    types: [created]

jobs:
  pr-comment:
    # åªåœ¨PRçš„è¯„è®ºä¸Šè§¦å‘ï¼Œå¿½ç•¥issueçš„è¯„è®º
    if: ${{ github.event.issue.pull_request }}
    runs-on: ubuntu-latest
    steps:
      # æ£€å‡ºä»£ç 
      - uses: actions/checkout@v3

      # è·å–PRè¯¦ç»†ä¿¡æ¯
      - name: Get PR Details
        id: pr
        uses: actions/github-script@v6
        with:
          script: |
            const pull = await github.rest.pulls.get({
              owner: context.repo.owner,
              repo: context.repo.repo,
              pull_number: context.issue.number
            });
            return pull.data;

      # è¿™é‡Œå¯ä»¥è¿è¡Œä½ çš„è‡ªå®šä¹‰è„šæœ¬
      - name: Run Custom Script
        id: script
        run: |
          # è¿™é‡Œæ”¾ç½®ä½ è¦è¿è¡Œçš„è„šæœ¬
          # ä¾‹å¦‚ï¼š
          echo "Processing comment: ${{ github.event.comment.body }}"
          # å°†è„šæœ¬çš„è¾“å‡ºä¿å­˜åˆ°è¾“å‡ºå˜é‡ä¸­
          echo "script_output=Hello from the script!" >> $GITHUB_OUTPUT

      # å›å¤è¯„è®º
      - name: Reply to Comment
        uses: actions/github-script@v6
        with:
          script: |
            const scriptOutput = '${{ steps.script.outputs.script_output }}';
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number,
              body: `ğŸ‘‹ Thanks for your comment!\n\nScript output: ${scriptOutput}`
            });
